{% extends "base.html" %}
{% block title %}ê´€ë¦¬ì ì˜ˆì•½ í™•ì¸{% endblock %}

{% block content %}
    <h2>ê´€ë¦¬ì ì˜ˆì•½ í˜„í™©</h2>
    <form method="post">
        <div style="margin-bottom: 10px">
            <label>ì˜ˆì•½ ì˜¤í”ˆ ì‹œê°„: </label>
            <input name="open_time" type="datetime-local" value="{{ open_time }}">
            <button type="submit" name="action" value="set_open">ì €ì¥</button>
        </div>
        <div style="margin-bottom: 10px">
            <label>ì´ë¦„:</label>
            <input name="admin_name" placeholder="ì´ë¦„ ì…ë ¥">
            <label>ì‹œê°„:</label>
            <select name="admin_time">
                {% for s in timeslots %}
                    {% set is_morning = s.time < '2025-05-25 12:30' %}
                    {% if is_morning %}
                        <option value="{{ s.time }} (ë°–)">{{ s.time }} (ë°–)</option>
                    {% else %}
                        <option value="{{ s.time }} (ì•ˆ)">{{ s.time }} (ì•ˆ)</option>
                        <option value="{{ s.time }} (ë°–)">{{ s.time }} (ë°–)</option>
                    {% endif %}
                {% endfor %}
            </select>
            <button type="submit" name="action" value="add_reservation">ì˜ˆì•½ ì¶”ê°€</button>
        </div>
        <div>
            <button type="submit" name="action" value="reset_used">ì´ìš©ì™„ë£Œ ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
    </form>

    <h3>ğŸ”µ ì•ˆìª½ ì˜ˆì•½</h3>
    <table border="1" cellpadding="5" style="margin-top: 10px; border-collapse: collapse;">
        <tr>
            <th>ì‹œê°„</th>
            <th>ì˜ˆì•½ì</th>
            <th>ë²ˆí˜¸</th>
            <th>ì´ìš© ì™„ë£Œ</th>
            <th>ì‚­ì œ</th>
        </tr>
        {% for r in reservations if '(ì•ˆ)' in r.timeslot %}
            <tr>
                <td>{{ r.timeslot }}</td>
                <td>{{ r.name }}</td>
                <td>{{ r.order }}</td>
                <td>
                    <form method="post" style="display:inline;">
                        <input type="hidden" name="id" value="{{ r.id }}">
                        <button name="action" value="toggle_used">{{ "âœ…" if r.used else "âŒ" }}</button>
                    </form>
                </td>
                <td>
                    <form method="post" style="display:inline;">
                        <input type="hidden" name="id" value="{{ r.id }}">
                        <button name="action" value="delete">ì‚­ì œ</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
    </table>

    <h3>ğŸŸ¢ ë°”ê¹¥ìª½ ì˜ˆì•½</h3>
    <table border="1" cellpadding="5" style="margin-top: 10px; border-collapse: collapse;">
        <tr>
            <th>ì‹œê°„</th>
            <th>ì˜ˆì•½ì</th>
            <th>ë²ˆí˜¸</th>
            <th>ì´ìš© ì™„ë£Œ</th>
            <th>ì‚­ì œ</th>
        </tr>
        {% for r in reservations if '(ë°–)' in r.timeslot or '(ì•ˆ)' not in r.timeslot %}
            <tr>
                <td>{{ r.timeslot }}</td>
                <td>{{ r.name }}</td>
                <td>{{ r.order }}</td>
                <td>
                    <form method="post" style="display:inline;">
                        <input type="hidden" name="id" value="{{ r.id }}">
                        <button name="action" value="toggle_used">{{ "âœ…" if r.used else "âŒ" }}</button>
                    </form>
                </td>
                <td>
                    <form method="post" style="display:inline;">
                        <input type="hidden" name="id" value="{{ r.id }}">
                        <button name="action" value="delete">ì‚­ì œ</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
    </table>

    <a class="action-link" href="/">â† ë©”ì¸ìœ¼ë¡œ</a>
{% endblock %}
