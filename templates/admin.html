{% extends "base.html" %}
{% block title %}ê´€ë¦¬ì ì˜ˆì•½ í™•ì¸{% endblock %}

{% block content %}
    <h2>ê´€ë¦¬ì ì˜ˆì•½ í˜„í™©</h2>

    <form method="post">
        <div style="margin-bottom: 10px">
            <label>ì˜ˆì•½ ì˜¤í”ˆ ì‹œê°„: </label>
            <input name="open_time" type="datetime-local" value="{{ open_time }}">
            <button type="submit" name="action" value="set_open">ì €ì¥</button>
        </div>

        <div style="margin-bottom: 10px">
            <label>ì´ë¦„:</label>
            <input name="admin_name" placeholder="ì´ë¦„ ì…ë ¥">
            <label>ì‹œê°„:</label>
            <input name="admin_time" placeholder="ì˜ˆ: 2025-05-25 10:30 (ì•ˆ)">
            <button type="submit" name="action" value="add_reservation">ì˜ˆì•½ ì¶”ê°€</button>
        </div>

        <div style="margin-bottom: 10px">
            <button type="submit" name="action" value="reset_used">ì´ìš©ì™„ë£Œ ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
    </form>

    <hr>

    <h3>ğŸ”µ ì•ˆìª½ ì˜ˆì•½</h3>
    {% for time, slots in grouped.items() if '(ì•ˆ)' in time %}
        <table border="1" cellpadding="5" style="margin-bottom: 20px; border-collapse: collapse;">
            <caption style="font-weight: bold; margin-bottom: 5px;">ğŸ•’ {{ time }}</caption>
            <tr>
                <th>ì˜ˆì•½ì</th>
                <th>ë²ˆí˜¸</th>
                <th>ì´ìš© ì™„ë£Œ</th>
                <th>ì‚­ì œ</th>
            </tr>
            {% for r in slots %}
                <tr>
                    <td>{{ r.name }}</td>
                    <td>{{ r.order_in_slot }}</td>
                    <td>
                        <form method="post" action="/admin/toggle_used" style="display:inline;">
                            <input type="hidden" name="id" value="{{ r.id }}">
                            <button>{{ "âœ…" if r.used else "âŒ" }}</button>
                        </form>
                    </td>
                    <td>
                        <form method="post" action="/admin/delete_reservation" style="display:inline;">
                            <input type="hidden" name="reservation_id" value="{{ r.id }}">
                            <button type="submit">ì‚­ì œ</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% endfor %}

    <h3>ğŸŸ¢ ë°”ê¹¥ìª½ ì˜ˆì•½</h3>
    {% for time, slots in grouped.items() if '(ë°–)' in time or '(ì•ˆ)' not in time %}
        <table border="1" cellpadding="5" style="margin-bottom: 20px; border-collapse: collapse;">
            <caption style="font-weight: bold; margin-bottom: 5px;">ğŸ•’ {{ time }}</caption>
            <tr>
                <th>ì˜ˆì•½ì</th>
                <th>ë²ˆí˜¸</th>
                <th>ì´ìš© ì™„ë£Œ</th>
                <th>ì‚­ì œ</th>
            </tr>
            {% for r in slots %}
                <tr>
                    <td>{{ r.name }}</td>
                    <td>{{ r.order_in_slot }}</td>
                    <td>
                        <form method="post" action="/admin/toggle_used" style="display:inline;">
                            <input type="hidden" name="id" value="{{ r.id }}">
                            <button>{{ "âœ…" if r.used else "âŒ" }}</button>
                        </form>
                    </td>
                    <td>
                        <form method="post" action="/admin/delete_reservation" style="display:inline;">
                            <input type="hidden" name="reservation_id" value="{{ r.id }}">
                            <button type="submit">ì‚­ì œ</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% endfor %}

    <a class="action-link" href="/">â† ë©”ì¸ìœ¼ë¡œ</a>
{% endblock %}
